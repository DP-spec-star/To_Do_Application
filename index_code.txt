<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskMaster - Professional To-Do Application</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .task-item {
            transition: all 0.3s ease;
        }
        .task-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .completed {
            opacity: 0.7;
            text-decoration: line-through;
        }
        .drag-handle {
            cursor: grab;
        }
        .drag-handle:active {
            cursor: grabbing;
        }
        .sortable-ghost {
            opacity: 0.4;
        }
        .login-form, .register-form {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .task-stats {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        .task-app {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="min-h-screen gradient-bg">
    <!-- Authentication Section -->
    <div id="authSection" class="min-h-screen flex items-center justify-center p-4">
        <div class="w-full max-w-md">
            <!-- Login Form -->
            <div id="loginForm" class="login-form rounded-2xl shadow-2xl p-8 border border-white/20">
                <div class="text-center mb-8">
                    <div class="w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-tasks text-white text-2xl"></i>
                    </div>
                    <h1 class="text-3xl font-bold text-gray-800 mb-2">TaskMaster</h1>
                    <p class="text-gray-600">Sign in to manage your tasks</p>
                </div>
                
                <form id="loginFormElement" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" id="loginEmail" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input type="password" id="loginPassword" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                    </div>
                    <button type="submit" class="w-full btn-primary text-white py-3 rounded-lg font-semibold">
                        Sign In
                    </button>
                </form>
                
                <div class="mt-6 text-center">
                    <p class="text-gray-600">Don't have an account? 
                        <button id="showRegister" class="text-purple-600 hover:text-purple-800 font-semibold">Sign up</button>
                    </p>
                </div>
            </div>

            <!-- Register Form -->
            <div id="registerForm" class="register-form rounded-2xl shadow-2xl p-8 border border-white/20 hidden">
                <div class="text-center mb-8">
                    <div class="w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-user-plus text-white text-2xl"></i>
                    </div>
                    <h1 class="text-3xl font-bold text-gray-800 mb-2">Join TaskMaster</h1>
                    <p class="text-gray-600">Create your account to get started</p>
                </div>
                
                <form id="registerFormElement" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                        <input type="text" id="registerName" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" id="registerEmail" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input type="password" id="registerPassword" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                    </div>
                    <button type="submit" class="w-full btn-primary text-white py-3 rounded-lg font-semibold">
                        Create Account
                    </button>
                </form>
                
                <div class="mt-6 text-center">
                    <p class="text-gray-600">Already have an account? 
                        <button id="showLogin" class="text-purple-600 hover:text-purple-800 font-semibold">Sign in</button>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Task Application -->
    <div id="taskApp" class="hidden min-h-screen p-4">
        <div class="max-w-6xl mx-auto">
            <!-- Header -->
            <div class="task-app rounded-2xl shadow-2xl p-6 mb-6 border border-white/20">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">Welcome back, <span id="userName">User</span>!</h1>
                        <p class="text-gray-600">Let's get things done today</p>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="task-stats text-white px-6 py-3 rounded-lg">
                            <div class="text-center">
                                <div class="text-2xl font-bold" id="taskCount">0</div>
                                <div class="text-sm opacity-90">Tasks</div>
                            </div>
                        </div>
                        <button id="logoutBtn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors">
                            <i class="fas fa-sign-out-alt mr-2"></i>Logout
                        </button>
                    </div>
                </div>
            </div>

            <!-- Task Input -->
            <div class="task-app rounded-2xl shadow-2xl p-6 mb-6 border border-white/20">
                <form id="taskForm" class="flex flex-col md:flex-row gap-4">
                    <div class="flex-1">
                        <input type="text" id="taskInput" placeholder="What needs to be done?" required
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                    </div>
                    <div class="flex gap-2">
                        <select id="taskPriority" class="px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <option value="low">Low Priority</option>
                            <option value="medium" selected>Medium Priority</option>
                            <option value="high">High Priority</option>
                        </select>
                        <button type="submit" class="btn-primary text-white px-6 py-3 rounded-lg font-semibold whitespace-nowrap">
                            <i class="fas fa-plus mr-2"></i>Add Task
                        </button>
                    </div>
                </form>
            </div>

            <!-- Task Filters -->
            <div class="task-app rounded-2xl shadow-2xl p-6 mb-6 border border-white/20">
                <div class="flex flex-wrap gap-4 items-center">
                    <span class="text-gray-700 font-medium">Filter:</span>
                    <div class="flex gap-2">
                        <button class="filter-btn active bg-purple-500 text-white px-4 py-2 rounded-lg" data-filter="all">All</button>
                        <button class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300" data-filter="pending">Pending</button>
                        <button class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300" data-filter="completed">Completed</button>
                    </div>
                    <div class="flex gap-2 ml-auto">
                        <button class="priority-filter bg-green-100 text-green-700 px-3 py-2 rounded-lg hover:bg-green-200" data-priority="low">Low</button>
                        <button class="priority-filter bg-yellow-100 text-yellow-700 px-3 py-2 rounded-lg hover:bg-yellow-200" data-priority="medium">Medium</button>
                        <button class="priority-filter bg-red-100 text-red-700 px-3 py-2 rounded-lg hover:bg-red-200" data-priority="high">High</button>
                    </div>
                </div>
            </div>

            <!-- Task List -->
            <div class="task-app rounded-2xl shadow-2xl p-6 border border-white/20">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Your Tasks</h2>
                    <button id="clearCompleted" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-trash mr-2"></i>Clear Completed
                    </button>
                </div>
                <div id="taskList" class="space-y-4">
                    <div id="emptyState" class="text-center py-12 text-gray-500">
                        <i class="fas fa-clipboard-list text-6xl mb-4 opacity-50"></i>
                        <p class="text-xl">No tasks yet. Add one above to get started!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Application State
        let currentUser = null;
        let tasks = [];
        let taskIdCounter = 1;
        let currentFilter = 'all';
        let currentPriorityFilter = null;

        // DOM Elements
        const authSection = document.getElementById('authSection');
        const taskApp = document.getElementById('taskApp');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const showRegisterBtn = document.getElementById('showRegister');
        const showLoginBtn = document.getElementById('showLogin');
        const loginFormElement = document.getElementById('loginFormElement');
        const registerFormElement = document.getElementById('registerFormElement');
        const logoutBtn = document.getElementById('logoutBtn');
        const userName = document.getElementById('userName');
        const taskForm = document.getElementById('taskForm');
        const taskInput = document.getElementById('taskInput');
        const taskPriority = document.getElementById('taskPriority');
        const taskList = document.getElementById('taskList');
        const taskCount = document.getElementById('taskCount');
        const emptyState = document.getElementById('emptyState');
        const clearCompletedBtn = document.getElementById('clearCompleted');

        // Initialize Sortable
        let sortable;

        // Event Listeners
        showRegisterBtn.addEventListener('click', () => {
            loginForm.classList.add('hidden');
            registerForm.classList.remove('hidden');
        });

        showLoginBtn.addEventListener('click', () => {
            registerForm.classList.add('hidden');
            loginForm.classList.remove('hidden');
        });

        loginFormElement.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Simple demo authentication
            if (email && password) {
                currentUser = { name: email.split('@')[0], email };
                showTaskApp();
            }
        });

        registerFormElement.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            // Simple demo registration
            if (name && email && password) {
                currentUser = { name, email };
                showTaskApp();
            }
        });

        logoutBtn.addEventListener('click', () => {
            currentUser = null;
            tasks = [];
            authSection.classList.remove('hidden');
            taskApp.classList.add('hidden');
            loginFormElement.reset();
            registerFormElement.reset();
        });

        taskForm.addEventListener('submit', (e) => {
            e.preventDefault();
            addTask();
        });

        clearCompletedBtn.addEventListener('click', () => {
            tasks = tasks.filter(task => !task.completed);
            renderTasks();
        });

        // Filter buttons
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.filter-btn').forEach(b => {
                    b.classList.remove('active', 'bg-purple-500', 'text-white');
                    b.classList.add('bg-gray-200', 'text-gray-700');
                });
                e.target.classList.add('active', 'bg-purple-500', 'text-white');
                e.target.classList.remove('bg-gray-200', 'text-gray-700');
                currentFilter = e.target.dataset.filter;
                renderTasks();
            });
        });

        // Priority filter buttons
        document.querySelectorAll('.priority-filter').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const priority = e.target.dataset.priority;
                if (currentPriorityFilter === priority) {
                    currentPriorityFilter = null;
                    e.target.style.opacity = '1';
                } else {
                    document.querySelectorAll('.priority-filter').forEach(b => b.style.opacity = '0.5');
                    currentPriorityFilter = priority;
                    e.target.style.opacity = '1';
                }
                renderTasks();
            });
        });

        // Functions
        function showTaskApp() {
            authSection.classList.add('hidden');
            taskApp.classList.remove('hidden');
            userName.textContent = currentUser.name;
            renderTasks();
            
            // Initialize sortable after showing the app
            setTimeout(() => {
                if (!sortable) {
                    sortable = Sortable.create(taskList, {
                        handle: '.drag-handle',
                        animation: 150,
                        ghostClass: 'sortable-ghost',
                        onEnd: function(evt) {
                            const movedTask = tasks.splice(evt.oldIndex, 1)[0];
                            tasks.splice(evt.newIndex, 0, movedTask);
                            renderTasks();
                        }
                    });
                }
            }, 100);
        }

        function addTask() {
            const text = taskInput.value.trim();
            const priority = taskPriority.value;
            
            if (text) {
                const task = {
                    id: taskIdCounter++,
                    text,
                    priority,
                    completed: false,
                    createdAt: new Date().toISOString()
                };
                
                tasks.unshift(task);
                taskInput.value = '';
                renderTasks();
            }
        }

        function toggleTask(id) {
            const task = tasks.find(t => t.id === id);
            if (task) {
                task.completed = !task.completed;
                renderTasks();
            }
        }

        function deleteTask(id) {
            tasks = tasks.filter(t => t.id !== id);
            renderTasks();
        }

        function editTask(id, newText) {
            const task = tasks.find(t => t.id === id);
            if (task) {
                task.text = newText;
                renderTasks();
            }
        }

        function getPriorityColor(priority) {
            switch (priority) {
                case 'high': return 'border-red-400 bg-red-50';
                case 'medium': return 'border-yellow-400 bg-yellow-50';
                case 'low': return 'border-green-400 bg-green-50';
                default: return 'border-gray-300 bg-white';
            }
        }

        function getPriorityBadge(priority) {
            switch (priority) {
                case 'high': return '<span class="bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full">High</span>';
                case 'medium': return '<span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full">Medium</span>';
                case 'low': return '<span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">Low</span>';
                default: return '';
            }
        }

        function renderTasks() {
            let filteredTasks = tasks;

            // Apply status filter
            if (currentFilter === 'completed') {
                filteredTasks = filteredTasks.filter(task => task.completed);
            } else if (currentFilter === 'pending') {
                filteredTasks = filteredTasks.filter(task => !task.completed);
            }

            // Apply priority filter
            if (currentPriorityFilter) {
                filteredTasks = filteredTasks.filter(task => task.priority === currentPriorityFilter);
            }

            taskCount.textContent = tasks.length;

            if (filteredTasks.length === 0) {
                emptyState.classList.remove('hidden');
                taskList.innerHTML = '';
                taskList.appendChild(emptyState);
                return;
            }

            emptyState.classList.add('hidden');

            taskList.innerHTML = filteredTasks.map(task => `
                <div class="task-item border-2 ${getPriorityColor(task.priority)} rounded-lg p-4 ${task.completed ? 'completed' : ''}" data-task-id="${task.id}">
                    <div class="flex items-center gap-4">
                        <div class="drag-handle text-gray-400 hover:text-gray-600">
                            <i class="fas fa-grip-vertical"></i>
                        </div>
                        <input type="checkbox" ${task.completed ? 'checked' : ''} 
                               onchange="toggleTask(${task.id})"
                               class="w-5 h-5 text-purple-600 rounded focus:ring-purple-500">
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="task-text text-lg ${task.completed ? 'line-through text-gray-500' : 'text-gray-800'}" 
                                      ondblclick="startEdit(${task.id}, this)">${task.text}</span>
                                ${getPriorityBadge(task.priority)}
                            </div>
                            <div class="text-sm text-gray-500">
                                Created: ${new Date(task.createdAt).toLocaleDateString()}
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="startEdit(${task.id})" 
                                    class="text-blue-500 hover:text-blue-700 p-2 rounded-lg hover:bg-blue-50">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteTask(${task.id})" 
                                    class="text-red-500 hover:text-red-700 p-2 rounded-lg hover:bg-red-50">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function startEdit(id, element) {
            const task = tasks.find(t => t.id === id);
            if (!task || task.completed) return;

            const currentText = task.text;
            const input = document.createElement('input');
            input.type = 'text';
            input.value = currentText;
            input.className = 'text-lg bg-transparent border-none outline-none flex-1';
            
            const taskTextElement = element || document.querySelector(`[data-task-id="${id}"] .task-text`);
            const parent = taskTextElement.parentNode;
            parent.replaceChild(input, taskTextElement);
            
            input.focus();
            input.select();

            function finishEdit() {
                const newText = input.value.trim();
                if (newText && newText !== currentText) {
                    editTask(id, newText);
                } else {
                    renderTasks();
                }
            }

            input.addEventListener('blur', finishEdit);
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    finishEdit();
                }
            });
        }

        // Initialize the app
        renderTasks();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'979ada1ab1cac183',t:'MTc1Njk2MTI3OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
